(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{4209:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/payment/[method]",function(){return t(3679)}])},3679:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var r=t(5893),o=t(5617),c=t(2917),s=t(4051),i=t.n(s),a=t(7294),u=t(1163),l=t(6204),h=t(7357),d=t(2882),f=t(7906),x=t(295),p=t(3816),v=t(3252),m=t(657),j=t(6580),b=t(8951),y=t(1425),Z=t(3321),w=t(8210),g=t(7426),_=t(4243),k=t(2055);function S(e,n,t,r,o,c,s){try{var i=e[c](s),a=i.value}catch(u){return void t(u)}i.done?n(a):Promise.resolve(a).then(r,o)}function O(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){O(e,n,t[n])}))}return e}var D={borderBottom:"none",color:g.DM.white},I=function(e){var n=e.method,t=e.paymentInfo,o=new k.Z,c=(0,u.useRouter)(),s=(0,a.useState)(""),l=s[0],O=s[1],I=(0,a.useState)(!1),E=I[0],C=I[1],M=(0,a.useState)(!1),N=M[0],T=M[1],X=(0,a.useState)(null),F=X[0],q=X[1],B=(0,a.useState)(""),G=B[0],J=B[1],R=(0,a.useState)({}),z=R[0],L=R[1];(0,a.useEffect)((function(){t&&L(t)}),[t]);var A=function(e){var n=setInterval((function(){var t=(new Date).getTime(),r=1e3*e-t,o=Math.floor(r%36e5/6e4),c=Math.floor(r%6e4/1e3);if(r<0)return clearInterval(n),O(""),void C(!0);O(o+":"+c)}))},H=function(){var e,n=(e=i().mark((function e(n){var t,r,c,s,a,u,l,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={payment_reference_id:n},e.prev=1,e.next=4,o.checkBillingStatus(t);case 4:return r=e.sent,e.next=7,r.data.data;case 7:if(1!==(c=e.sent).status&&3!==c.status){e.next=14;break}return T(!0),J("Thanh to\xe1n th\xe0nh c\xf4ng!"),q(c.status),localStorage.removeItem("paymentData"),e.abrupt("return");case 14:if(6!==c.status){e.next=20;break}return T(!0),J("Thanh to\xe1n kh\xf4ng th\xe0nh c\xf4ng, vui l\xf2ng th\u1eed l\u1ea1i!"),q(c.status),localStorage.removeItem("paymentData"),e.abrupt("return");case 20:if(5!==c.status&&2!==c.status){e.next=25;break}return e.next=23,new Promise((function(e){return setTimeout(e,5e3)}));case 23:return e.next=25,H(n);case 25:e.next=38;break;case 27:if(e.prev=27,e.t0=e.catch(1),s=e.t0.response.data.error,i=s,!(null!=(d=Object)&&"undefined"!==typeof Symbol&&d[Symbol.hasInstance]?d[Symbol.hasInstance](i):i instanceof d)){e.next=36;break}for(u in a="",s)l=Object.keys(s[u])[0],h=s[u][l],a+="".concat(l," ").concat(h," \n");return T(!0),J(a),e.abrupt("return");case 36:etIsPaymentFinish(!0),J(s);case 38:case"end":return e.stop()}var i,d}),e,null,[[1,27]])})),function(){var n=this,t=arguments;return new Promise((function(r,o){var c=e.apply(n,t);function s(e){S(c,r,o,s,i,"next",e)}function i(e){S(c,r,o,s,i,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}();(0,a.useEffect)((function(){if(t)return A(t.expiry_time),void H(t.payment_reference_id);var e=localStorage.getItem("paymentData");if(e){var n=JSON.parse(e);return L(n),A(n.expiry_time),void H(n.payment_reference_id)}c.push("/checkout")}),[]);return"shopee"===n?(0,r.jsxs)(h.Z,{sx:P({},(0,w.X)("center","center")),children:[(0,r.jsx)(h.Z,{children:(0,r.jsx)(d.Z,{children:(0,r.jsx)(f.Z,{"aria-label":"simple table",children:(0,r.jsxs)(x.Z,{children:[(0,r.jsxs)(p.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,r.jsx)(v.Z,{sx:D,component:"th",scope:"row",children:"Lo\u1ea1i \u0111\u01a1n h\xe0ng"}),(0,r.jsx)(v.Z,{sx:D,children:Object.keys(z).length>0?JSON.parse(null===z||void 0===z?void 0:z.additional_info).field1:""})]}),(0,r.jsxs)(p.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,r.jsx)(v.Z,{sx:D,component:"th",scope:"row",children:"T\u1ed5ng ti\u1ec1n"}),(0,r.jsx)(v.Z,{sx:D,children:(0,_.Z)(null===z||void 0===z?void 0:z.amount)})]}),(0,r.jsxs)(p.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,r.jsx)(v.Z,{sx:D,component:"th",scope:"row",children:"\u0110\u01a1n v\u1ecb ti\u1ec1n t\u1ec7"}),(0,r.jsx)(v.Z,{sx:D,children:null===z||void 0===z?void 0:z.currency})]}),(0,r.jsxs)(p.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,r.jsx)(v.Z,{sx:D,component:"th",scope:"row",children:"Giao d\u1ecbch h\u1ebft h\u1ea1n sau"}),(0,r.jsx)(v.Z,{sx:D,children:l})]}),(0,r.jsxs)(p.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,r.jsx)(v.Z,{sx:D,component:"th",scope:"row",children:"M\xe3 giao d\u1ecbch"}),(0,r.jsx)(v.Z,{sx:D,children:null===z||void 0===z?void 0:z.payment_reference_id})]})]})})})}),(0,r.jsx)(h.Z,{children:(0,r.jsx)("img",{src:(null===z||void 0===z?void 0:z.url)||"",alt:"qrcode"})}),(0,r.jsxs)(m.Z,{open:N,onClose:function(){T(!1)},PaperProps:{style:{backgroundColor:g.DM.bg1}},children:[(0,r.jsx)(j.Z,{children:(0,r.jsx)(b.Z,{sx:{color:g.DM.white},children:G})}),(0,r.jsx)(y.Z,{sx:P({},(0,w.X)("center","center"),{whiteSpace:"pre-line"}),children:(0,r.jsx)(Z.Z,{onClick:function(){return 1===F||3===F?(T(!1),void c.push("/")):6===F?(T(!1),void c.push("/checkout")):void T(!1)},autoFocus:!0,children:"\u0110\xf3ng"})})]}),(0,r.jsxs)(m.Z,{open:E,onClose:function(){C(!1)},PaperProps:{style:{backgroundColor:g.DM.bg1}},children:[(0,r.jsx)(j.Z,{children:(0,r.jsx)(b.Z,{sx:{color:g.DM.white},children:"Giao d\u1ecbch \u0111\xe3 h\u1ebft h\u1ea1n, vui l\xf2ng thanh to\xe1n l\u1ea1i"})}),(0,r.jsx)(y.Z,{sx:P({},(0,w.X)("center","center"),{whiteSpace:"pre-line"}),children:(0,r.jsx)(Z.Z,{onClick:function(){c.push("/checkout")},autoFocus:!0,children:"Thanh to\xe1n l\u1ea1i"})})]})]}):(0,r.jsx)("img",{src:(null===t||void 0===t?void 0:t.url)||"",alt:"qrcode"})};function E(){var e=(0,u.useRouter)().query.method,n=(0,o.v9)(l.cy);return(0,r.jsx)(I,{method:e,paymentInfo:n})}var C=function(){return(0,r.jsx)(o.zt,{store:c.Z,children:(0,r.jsx)(E,{})})}},4243:function(e,n,t){"use strict";function r(e){return new Intl.NumberFormat("de-DE").format(e)}t.d(n,{Z:function(){return r}})}},function(e){e.O(0,[774,888,179],(function(){return n=4209,e(e.s=n);var n}));var n=e.O();_N_E=n}]);